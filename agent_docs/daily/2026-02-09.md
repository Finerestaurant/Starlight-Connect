# 2026년 2월 9일: 프론트엔드 전환 및 아키텍처 재구축

**핵심 목표:** `PLAN.md`에 명시된 대로, 프로젝트의 시각화 방향을 3D에서 2D로 완전히 전환하고, 프론트엔드 코드를 보다 전문적이고 확장 가능한 구조로 리팩토링했으며, 사용자 경험을 개선했습니다.

-   **시각화 라이브러리 교체:**
    -   기존 3D 렌더링 라이브러리(`react-three-fiber`, `three`)를 모두 제거했습니다.
    -   정보 전달력이 뛰어난 2D 그래프 시각화 라이브러리 `react-flow`를 도입했으며, 사용자의 요청에 따라 최신 버전인 `@xyflow/react` (v11+)로 성공적으로 업그레이드했습니다.

-   **프론트엔드 모듈화 리팩토링:**
    -   단일 파일(`App.jsx`)에 혼재되어 있던 모든 로직을 역할에 따라 명확하게 분리했습니다.
    -   **`hooks/useGraphData.jsx`:** 데이터 페칭, 로딩/에러 상태 관리, React Flow의 `nodes` 및 `edges` 상태 관리를 책임지는 커스텀 훅을 생성했습니다.
    -   **`utils/layout.js`:** API 응답 데이터를 React Flow 형식으로 변환하고, 노드의 시각적 레이아웃과 스타일을 결정하는 순수 함수를 분리했습니다.
    -   **`App.jsx`:** 이제 상위 컴포넌트로서, 사용자의 인터랙션(포커스 변경, 드래그)를 관리하고, 분리된 훅과 컴포넌트를 조립하는 역할만 담당하여 코드가 매우 간결해졌습니다.

-   **코드 품질 개선 (계층 구조 명시):**
    -   사용자의 제안에 따라, 노드 생성 시 ID 문자열을 분석하는 대신 각 노드의 `data` 객체에 `degree` 프로퍼티(0: 중심, 1: 1차, 2: 2차)를 명시적으로 추가했습니다.
    -   `focusType === 'person'` 뷰에서는 **중심 인물(0차), 연결된 노래(1차), 협업자 인물(2차)**의 계층 구조를 따릅니다.
    -   이를 통해 드래그 로직 등에서 노드의 계층을 보다 명확하고 안정적으로 식별할 수 있게 되어 코드의 가독성과 유지보수성이 크게 향상되었습니다.

-   **인터랙션 로직 수정 및 추가 (그룹 하이라이팅 & 계층적 드래그):**
    -   **계층적 드래그:** 2차 노드(예: 협업자)를 드래그하면, 그와 연결된 모든 1차 노드(예: 노래)가 함께 따라 움직이도록 드래그 메커니즘을 완성했습니다.
    -   **확장된 그룹 하이라이팅:**
        -   사용자 피드백을 반영하여 하이라이트 로직을 확장했습니다.
        -   이제 **2차 노드를 드래그하면, 그와 연결된 1차 노드(노래)뿐만 아니라, 그 1차 노드를 중심으로 한 전체 협업 그룹(다른 2차 노드 및 중심 노드 포함)이 모두 함께 강조 표시**됩니다.
        -   이를 통해 사용자가 특정 관계망 전체를 한눈에 파악하고 조작할 수 있도록 시각적 피드백을 극대화했습니다.

-   **버그 수정 및 안정화:**
    -   라이브러리 버전 변경에 따른 import 경로 문제 및 API 사용법 오류를 수정했습니다.
    -   잘못된 `try-catch-finally` 구문 오류를 바로잡아 데이터 페칭 로직의 안정성을 확보했습니다.

---

## 현재 아키텍처

### 프론트엔드 (`/frontend`)

-   **프레임워크:** React (Vite 기반)
-   **2D 렌더링:** `@xyflow/react` (React Flow v11+)
-   **주요 특징:**
    -   `degree` 프로퍼티를 통한 명확한 그래프 계층 구조 관리.
    -   노드 클릭을 통한 동적 데이터 로딩 및 뷰 전환.
    -   2차 노드 드래그 시, 연결된 1차 노드가 함께 움직이는 정교한 드래그 인터랙션.
    -   **드래그 시 전체 협업 그룹을 강조**하는 확장된 하이라이팅 기능.
    -   역할 기반으로 분리된 모듈식 코드 구조 (`hooks`, `utils`).

### 백엔드 (`/backend`)

-   **프레임워크:** Python, FastAPI
-   **데이터베이스:** SQLite
-   **데이터 소스:** `Genius.com` 공식 API
-   **주요 기능:** Genius API 연동을 통한 노래/인물 정보 검색 및 로컬 DB 저장, 2D 시각화에 필요한 협업 데이터 제공.

---

## 향후 계획 (`changeplan.md` 기반)

-   **데이터 수집 전략 변경:** `changeplan.md`에 따라, 현재의 API 호출 방식에서 **대규모 크롤링 방식으로 전환**하여 데이터베이스를 효율적으로 확장하는 것이 최우선 과제입니다.
    -   **기술:** `requests`, `BeautifulSoup4`
    -   **목표:** 위키 사이트(예: 나무위키)의 비정형 데이터를 정형화하여 DB에 저장하는 크롤러 개발.
